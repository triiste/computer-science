# 设计模式-代理模式

代理模式(Proxy),为其他对象提供一种代理以控制对这个对象的访问。

## 代理模式大致逻辑

### Subject类

~~~java
abstract class Subject{
    public abstract void Request();
}
~~~

### RealSubject类，定义Proxy所代表的真实实体

~~~java
class RealSubject :Subject{
    public override void Request(){
        Console.WriteLine("真实的请求")；
    }
}
~~~

### Proxy类，保存一个引用使得代理可以访问实体，并提供一个与Subject的接口相同的接口

~~~java
class Proxy:Subject{
    RealSubject readSubject;
    public override void Request(){
        if(realSubject == null){
            realSubject = new RealSubject();
        }
        realSubject.Request();
    }
}
~~~

### 客户端代码

~~~java
static void Main(string[] args){
    Proxy proxy = new Proxy();
    proxy.Request();
    Console.Read();
}
~~~

## 代理模式应用 -代送礼物

被追求者类

~~~java
class SchoolGirl
{
    private string name;
    public string Name
    {
        get { return name; }
        set { name = value;}
    }
}
~~~

代理接口

~~~java
interface GiveGift{
    void GiveDolls();
    void GiveFlowers();
    void GiveChocolate();
}
~~~

追求者类如下

~~~java
class Pursuit:GiveGift{
    SchoolGirl mm;
    public Pursuit(SchoolGirl mm){
        this.mm = mm;
    }
    public void GiveDolls(){
        Gonsole.WriteLine(mm.Name + "送你洋娃娃");
    }
    public void GiveFlowers(){
        Console.WriteLine(mm.Name + "送你鲜花");
    }
    public void GiveChocolate(){
        Console.WriteLine(mm.Name + "送你巧克力");
    }    
}
~~~

代理类如下

~~~java
class Proxy:GiveGift{
    Pursuit gg;
    public Proxy(SchoolGirl mm){
        gg = new Pursuit(mm);
    }
    public void GiveDolls(){
        gg.GiveDolls();
    }
    public void GiveFlowers(){
        gg.GiveFlowers();
    }
    public void GiveChocolate(){
        gg.GiveChocolate();
    }
}
~~~

客户端如下

~~~java
static void Main(string[] args){
    SchoolGirl jiaojiao = new SchoolGirl();
    jiaojiao.Name = "李娇娇";
    Proxy daili = new Proxy(jiaojiao);
    daili.GiveDolls();
    daili.GiveFlowers();
    daili.GiveChocolate();
    Console.Read();
}
~~~

## 总结代理模式常见应用

1.远程代理，也就是为一个对象在不同的地址空间提供局部代表。这样可以隐藏一个对象存在不同地址空间的事实。

2.虚拟代理，是根据需要创建开销很大的对象。通过它来存放实例化需要很长时间的真实对象。

3.安全代理，用来控制真实对象访问时的权限。

4.智能指引，是指当调用真实的对象时，代理处理另外一些事。

代理模式其实就是在访问对象时引入一定程度的间接性，因为这种间接性，可以附加多种用途！！！